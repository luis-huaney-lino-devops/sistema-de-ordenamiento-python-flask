"use strict";var data=new Array();var asort=null;var asort={encours:false,phase:0,i:0,t:0,nb_comp:0,nb_echanges:0,courant:null,oldpos:0,tri_en_cours:false,num_etape:0,etapes:[]};var vitesse=100;function init_tempo(){if(asort.encours){setTimeout("init_tempo()",5)}if(asort.timer){window.clearInterval(asort.timer);asort.encours=true}switch(document.getElementsByName("o2")[0].value.substr(0,1)){case"0":vitesse=0;break;case"1":vitesse=500;break;case"2":vitesse=250;break;case"3":vitesse=100;break;case"4":vitesse=10;break;default:vitesse=100}var a;if(vitesse==0){switch(asort.lang){case"fr":a={label:"Suivant",icons:{primary:"ui-icon-play"}};break;case"es":a={label:"Siguiente",icons:{primary:"ui-icon-play"}};break;default:a={label:"Next",icons:{primary:"ui-icon-play"}};break}}else{switch(asort.lang){case"fr":a={label:"Stop",icons:{primary:"ui-icon-play"}};break;case"es":a={label:"Stop",icons:{primary:"ui-icon-play"}};break;default:a={label:"Stop",icons:{primary:"ui-icon-play"}};break}}$("#play").button("option",a);if((asort.encours)||(asort.tri_en_cours)){if(vitesse>0){asort.timer=window.setInterval("f_sd_sort(asort,data)",vitesse)}asort.encours=false}}function add_etape(a,c,b){asort.etapes[asort.num_etape]={action:a,el1:c,el2:b}}function init_sort(){var e,d,c,a;var f=[{v:1,color:"#000000"},{v:2,color:"#1a0e00"},{v:3,color:"#261b00"},{v:4,color:"#022433"},{v:5,color:"#081040"},{v:6,color:"#4c2800"},{v:7,color:"#594000"},{v:8,color:"#044866"},{v:9,color:"#0f1d73"},{v:10,color:"#804400"},{v:11,color:"#8c6500"},{v:12,color:"#076c99"},{v:13,color:"#162aa6"},{v:14,color:"#b25f00"},{v:15,color:"#bf8900"},{v:16,color:"#0990cc"},{v:17,color:"#1c36d9"},{v:18,color:"#e67a00"},{v:19,color:"#f2ae00"},{v:20,color:"#0bb5ff"}];switch(document.getElementsByName("o1")[0].value.substr(0,1)){case"1":asort.datastyle=1;data=[];for(e=0;e<20;e++){data[e]=f[19-e]}break;case"2":data=[];asort.datastyle=2;for(e=0;e<20;e++){data[e]=f[e]}break;case"4":data=[];asort.datastyle=4;pire_des_cas(data);break;case"5":data=[];asort.datastyle=5;meilleur_des_cas(data);break;case"6":asort.datastyle=6;$("#ins_cnv").mousemove(mousemove);$("#ins_cnv").mousedown(mousedown);$("#ins_cnv").mouseup(mouseup);$("#ins_cnv").mouseleave(mouseleave);if(!data){data=[]}if(data.length<20){for(e=0;e<20;e++){data[e]=f[e]}}else{for(e=0;e<20;e++){if(!data[e]){d=0;a=false;while((!a)&&(d<20)){a=true;for(c=0;c<20;c++){if(data[c]==f[d]){a=false;break}}if(a){data[e]=f[d]}d++}}}}break;default:data=[];asort.datastyle=3;for(e=0;e<20;e++){d=Math.floor((Math.random()*20));while(!f[d]){d=Math.floor((Math.random()*20))}data[e]=f[d];f[d]=null}break}for(e=0;e<20;e++){data[e].etapes=[e];data[e].x=20+(e*43);data[e].y=100;data[e].drag=false}asort.lang=$("html")[0].lang;var b;switch(asort.lang){case"fr":b={label:"Trier",icons:{primary:"ui-icon-play"}};break;case"es":b={label:"Ordenar",icons:{primary:"ui-icon-play"}};break;default:b={label:"Sort",icons:{primary:"ui-icon-play"}};break}$("#play").button("option",b);$("#o2").selectmenu("option","disabled",false);$("#o1").selectmenu("option","disabled",false);draw_sd()}function get_pos(){var a=0;for(a=0;a<20;a++){data[a].etapes.push(a)}draw_graph()}function start_sort(){var a;switch(asort.lang){case"fr":a={label:"Suivant",icons:{primary:"ui-icon-play"}};break;case"es":a={label:"Siguiente",icons:{primary:"ui-icon-play"}};break;default:a={label:"Next",icons:{primary:"ui-icon-play"}};break}asort.num_etape=0;asort.etapes=[];if(!asort.tri_en_cours){init_sort();init_tempo();asort.encours=false;asort.phase=0;asort.i=0;asort.t=0;asort.nb_comp=0;asort.nb_echanges=0;asort.courant=null;asort.oldpos=0;asort.tri_en_cours=true}if(vitesse>0){a={label:"Stop",icons:{primary:"ui-icon-stop"}};$("#play").button("option",a);asort.timer=window.setInterval("f_sd_sort(asort,data)",vitesse)}else{$("#play").button("option",a);f_sd_sort(asort)}$("#o1").selectmenu("option","disabled",true);draw_sd()}function stop_sort(){if(asort.timer){window.clearInterval(asort.timer);asort.timer=null}asort.en_cours=false;asort.tri_en_cours=false;asort.phase=0;for(i=0;i<data.length;i++){if(!data[i]){init_sort();break}else{data[i].drag=false;data[i].x=20+(i*43)}}draw_sd();var a;switch(asort.lang){case"fr":a={label:"Trier",icons:{primary:"ui-icon-play"}};break;case"es":a={label:"Ordenar",icons:{primary:"ui-icon-play"}};break;default:a={label:"Sort",icons:{primary:"ui-icon-play"}};break}$("#play").button("option",a);$("#o2").selectmenu("option","disabled",false);$("#o1").selectmenu("option","disabled",false)}function surligne(g,b){if((!g)||(g<" ")){return}var d=0,a,c,f,e;a=document.getElementById(g);if(a){c=a.getElementsByTagName("ol")[0];if(c){f=c.getElementsByTagName("li");for(d=0;d<f.length;d++){if(b.indexOf((d+1))>-1){f[d].style.border="1px solid red"}else{f[d].style.border="none"}}}}}function draw_schema(){var a=document.getElementById("schema"),o=0;if(a){var m=a.width,d=a.height,n=a.getContext("2d"),c=0,b=0,l=0,f=0,k=0,e=0,g=20;n.clearRect(0,0,m,d);n.lineWidth=2;n.beginPath();n.lineCap="round";n.strokeStyle="#0000FF";e=d/21;g=9;c=10+(9*(asort.etapes.length));m=$("#schema")[0].width;if(c>m){c=c+100;a.width=c;$("#ins_graph")[0].width=c}for(c=0;c<20;c++){n.moveTo(5,10+(c*e));n.lineTo(m-5,10+(c*e))}n.stroke();n.beginPath();n.fillStyle="#000000";for(c=0;c<asort.etapes.length;c++){if((asort.etapes[c])&&((5+c*g)<m)){if(asort.etapes[c].action=="S"){n.lineWidth=2;n.strokeStyle="#FF0000"}else{n.lineWidth=1;n.strokeStyle="#000000"}n.beginPath();f=asort.etapes[c].el1;n.moveTo(5+(c*g),10+(f*e));k=asort.etapes[c].el2;n.lineTo(5+(c*g),10+(k*e));n.stroke();n.fillRect(3+(c*g),8+(f*e),4,4);n.fillRect(3+(c*g),8+(k*e),4,4)}}n.stroke();n.beginPath()}}function draw_graph(){var a=document.getElementById("ins_graph"),o=0;if(a){var l=a.width,d=a.height,n=a.getContext("2d"),c=0,b=0,k=0,f=0,m=0,e=0,g=20;n.clearRect(0,0,l,d);e=Math.floor(d/21);for(c=0;c<20;c++){if(data[c]){if(data[c].etapes.length>0){g=Math.floor(l/data[c].etapes.length);if(g>20){g=20}else{if(g<5){g=5}}}else{g=20}n.strokeStyle=data[c].color;n.lineWidth=10;n.beginPath();n.lineCap="round";for(b=0;b<data[c].etapes.length;b++){f=5+data[c].etapes[b]*e;k=5+(b*g);if(b==0){k=5;n.moveTo(5,f);n.lineTo(k,f);n.globalAlpha=1}else{n.globalAlpha=0.5}n.lineTo(k,f)}n.lineTo(l-5,f);n.stroke()}}}}function end_drag(e){var d=0,c=0,a,b;if(e){while((d<data.length)&&(data[d])&&(!data[d].drag)){d++}if((d>0)&&(data[d])&&(e.x>=20)&&(e.x<880)){c=Math.floor((e.x-20)/43);if((c>=0)&&(c<20)){a=data[d];if(c<d){for(b=d;b>c;b--){data[b]=data[b-1]}data[c]=a}else{if(c>d){for(b=d;b<c;b++){data[b]=data[b+1]}data[c]=a}}}}}for(d=0;d<data.length;d++){if(data[d]){data[d].drag=false}}draw_sd()}function mousemove(b){if((asort.datastyle===6)&&(!asort.en_cours)&&(!asort.tri_en_cours)){var c=getmousepos(this,b),a=0;while((a<data.length)&&(data[a])&&(!data[a].drag)){a++}if((a<20)&&(data[a])&&(data[a].drag)){data[a].x=c.x-21;data[a].y=c.y;draw_sd()}}}function mousedown(c){if((asort.datastyle===6)&&(!asort.en_cours)&&(!asort.tri_en_cours)){var d=getmousepos(this,c),b=0,a=false;for(b=0;b<20;b++){data[b].drag=false}b=0;a=false;while((b<20)&&(!a)){if(true){if((d.x>=data[b].x)&&(d.x<=data[b].x+43)){a=true;data[b].drag=true;draw_sd()}}b++}}}function mouseup(a){if((asort.datastyle===6)&&(!asort.en_cours)&&(!asort.tri_en_cours)){var b=getmousepos(this,a);end_drag(b);draw_sd()}}function mouseleave(a){if((asort.datastyle===6)&&(!asort.en_cours)&&(!asort.tri_en_cours)){var b=getmousepos(this.canvas,a);end_drag(b)}}function getmousepos(d,b){if(!d){return}var a=d.getBoundingClientRect();return{x:(b.clientX-a.left)/(a.right-a.left)*d.width,y:(b.clientY-a.top)/(a.bottom-a.top)*d.height}};